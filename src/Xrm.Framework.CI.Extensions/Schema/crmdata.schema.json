{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "JSON Schema for crm data files",
  "self": {
    "name": "CrmData",
    "format": "http://json-schema.org/draft-07/schema#",
    "version": "1-0-0"
  },
  "properties": {
    "schema": {
      "type": "string",
      "enum": [ "https://github.com/malachyoc/xrm-ci-framework-extensions/_schema/crmdata.schema.json" ]
    },
    "schemaFormat": {
      "type": "string",
      "enum": [ "http://json-schema.org/draft-07/schema#" ]
    },
    "schemaVersion": {
      "type": "string",
      "enum": [ "1-0-0" ]
    },
    "entities": {
      "type": "array",
      "additionalItems": false,
      "items": {
        "oneOf": [
          { "$ref": "#/definitions/SdkMessage" },
          { "$ref": "#/definitions/EntityTarget" }
        ]
      }
    },
    "mappings": {
      "type": "array",
      "additionalItems": false,
      "items": {
        "$ref": "#/definitions/EntityMapping"
      }
    },
    "additionalProperties": false
  },
  "sdkmessages": {
    "DeleteAttributeRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "SdkMessage": {
          "type": "string",
          "enum": [ "DeleteAttributeRequest" ]
        }
      },
      "required": [ "LogicalName" ]
    },
    "SetStateRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "SdkMessage": {
          "type": "string",
          "enum": [ "SetStateRequest" ]
        },
        "Target": { "$ref": "#/definitions/Guid" },
        "LogicalName": {
          "type": "string"
        },
        "statecode": { "type": "number" },
        "statuscode": { "type": "number" }
      },
      "required": [ "LogicalName" ]
    },
    "GrantAccessRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "SdkMessage": {
          "type": "string",
          "enum": [ "GrantAccessRequest" ]
        },
        "Target": {},
        "Principal": {},
        "ReadAccess": { "type": "boolean" },
        "WriteAccess": { "type": "boolean" },
        "DeleteAccess": { "type": "boolean" },
        "AssignAccess": { "type": "boolean" },
        "AppendAccess": { "type": "boolean" },
        "AppendToAccess": { "type": "boolean" },
        "ShareAccess": { "type": "boolean" }
      },
      "required": [ "Principal", "Target" ]
    }
  },
  "definitions": {
    "SdkMessage": {
      "oneOf": [
        { "$ref": "#/sdkmessages/DeleteAttributeRequest" },
        { "$ref": "#/sdkmessages/SetStateRequest" },
        { "$ref": "#/sdkmessages/GrantAccessRequest" }
      ],
      "required": [ "SdkMessage" ]
    },
    "EntityTarget": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "LogicalName": {
          "type": "string"
        },
        "Id": {
          "$ref": "#/definitions/Guid"
        },
        "Attributes": {},
        "Operation": {
          "type": "string",
          "enum": [ "delete", "create", "update", "upsert", "associate", "addprivilege" ]
        }
      },
      "required": [ "LogicalName" ]
    },
    "EntityMapping": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "EntityLogicalName": {
          "type": "string"
        },
        "TargetQuery": {
          "type": [ "string", "null" ]
        },
        "SourceQuery": {
          "type": [ "string", "null" ]
        },
        "SourceId": {
          "$ref": "#/definitions/Guid"
        },
        "TargetId": {
          "$ref": "#/definitions/Guid"
        },
        "Attributes": {},
        "Operation": {
          "type": "string",
          "enum": [ "delete", "create", "update", "upsert" ]
        }
      },
      "required": [ "EntityLogicalName" ]
    },
    "Guid": {
      "type ": "string",
      "pattern": "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}",
      "length": 36
    }
  }
}
